/*
 MIT
  @version 1.0.3
  @git https://github.com/duzun/jAJAX
  @umd AMD, Browser, CommonJs
  @author DUzun.Me
*/
(function(B,t,w,q,H,u){("function"==typeof define&&define.amd?define:"undefined"!=typeof module&&module.exports?function(t,l){module.exports=l()}:function(q,l){t[B]=l()})([],function(){var C=w.noop||function(){},l=w.prototype,x=l.hasOwnProperty,I=l.toString,J="function"==typeof u.now?function(){return u.now()}:function(){return new u.getTime},D=function(e){return null===e?"Null":void 0===e?"Undefined":I.call(e).slice(8,-1)},E=function(e){return e instanceof H||"Function"==D(e)},y=E(q.isArray)?q.isArray:
q.isArray=function(e){return e instanceof q||"Array"==D(e)},g=function(e,h){if(!e)return e;var a,d,g;(d=y(e))||(d=x.call(e,"length")&&"number"===typeof e.length&&!E(e));if(d)for(a=0,g=e.length>>>0;a<g;a++){if(x.call(e,a)&&(d=e[a],!1===h.call(d,a,d,e)))return a}else for(a in e)if(x.call(e,a)&&(d=e[a],!1===h.call(d,a,d,e)))return a;return e},K=function(e){function h(a,d){e[a]=d}g(arguments,function(a,e){a&&g(e,h)});return e},f="undefined"!==typeof self&&"function"==typeof self.setTimeout?self:t;"function"!=
typeof f.setTimeout&&"undefined"!==typeof require&&(f=require("sdk/timers"));var z=f.setTimeout,L=f.clearTimeout,F={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},f=function h(a,d,f){var b=h.createXHR(!1);if(!b)return f&&f(null,"xhr","Couldn't create XHR object"),b;"string"==typeof a&&(a={url:a});a=K({url:"",type:"GET",cache:!1,timeout:null,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"",mimeType:"",
data:null,headers:null,error:null,success:null},a);var l={},n=function(a,c){l[a.toLowerCase()]=[a,c]},c=a.type,r,k=function(G,c,d,k){a.error&&a.error(d||k,c,G,k);f&&f(d||k,c,G,k)},M=function(c,A){var b=c.responseText,f=a.dataType||h.mimeToDataType(a.mimeType||c.getResponseHeader("content-type")),r;try{switch(f){case "json":b="responseJSON"in c?c.responseJSON:/^\s*$/.test(b)?null:h.parseJSON(b);break;case "xml":b=c.responseXML;break;case "script":(0,eval)(b)}}catch(g){r=g}r?k(r,"parsererror",c,A):
(a.success&&a.success(b,c.statusText,c,A),d&&d(b,c.statusText,c,A))},p=function(a,c){r&&L(r);200<=a.status&&300>a.status||304==a.status?M(a,c):k(a.statusText||null,a.status?"error":"abort",a,c)};g({"X-Requested-With":"XMLHttpRequest"},n);a.contentType&&n("Content-Type",a.contentType);n("Accept",(F[a.dataType]?F[a.dataType]+", ":"")+"*/*; q=0.01");g(a.headers,n);if("REQUEST"==h.xhr_type){g(a.data,function(a,c,b){null==c&&delete b[a]});var m={url:a.url,content:a.data?a.data:{},headers:{},onComplete:function(a){m.aborted||
p({getResponseHeader:function(c){return a.headers[c]},status:a.status,statusText:a.statusText,responseText:a.text,responseJSON:a.json},a)}};g(l,function(a,c){c[0]&&null!=c[0]&&(m.headers[c[0]]=c[1])});a.contentType&&(m.contentType=a.contentType);0<a.timeout&&(r=z(function(){m.aborted=J();k(null,"timeout",b)},a.timeout));c=c.toLowerCase();try{b.Request(m)[c]()}catch(t){try{m.headers["X-HTTP-Method-Override"]=c.toUpperCase(),b.Request(m).post()}catch(N){switch(c){case "delete":var v=new (require("sdk/net/xhr").XMLHttpRequest);
v.open(c,a.url);g(m.headers,function(a,c){v.setRequestHeader(a,c)});v.send();p(v);break;default:throw N;}}}}else c=c.toUpperCase(),b.open(c,a.url,!0),g(l,function(a,c){null!=c[1]&&b.setRequestHeader(c[0],c[1]+"")}),0<a.timeout&&(r=z(function(){b.onreadystatechange=C;b.abort();k(null,"timeout",b)},a.timeout)),n=function(){4==b.readyState&&(b.onreadystatechange=C,p(b))},b.send(a.data?h.param(a.data):null),4===b.readyState?z(n):b.onreadystatechange=n;return b};(function(f,a,d){function q(a,b,d,f){var p,
m=y(b),h=b&&b!==t&&!m&&w.getPrototypeOf(b)===l;g(b,function(b,g){p=y(g)?"array":typeof g;f&&(b=d?f:f+"["+(h||"object"==p||"array"==p?b:"")+"]");!f&&m?a.add(g.name,g.value):"array"==p||!d&&"object"==p?q(a,g,d,b):a.add(b,g)})}d.param=function(a,b){var d=[];d.add=function(a,c){this.push(f(a)+(null==c?"":"="+f(c)))};q(d,a,b);return d.join("&").replace(/%20/g,"+")};var b=/^(?:text|application)\/javascript/i,u=/^(?:text|application)\/xml/i;d.mimeToDataType=function(a){a&&(a=a.split(";",2)[0]);return a&&
("text/html"==a?"html":"application/json"==a?"json":b.test(a)?"script":u.test(a)&&"xml")||"text"};var n=a&&a.parse||t.json_decode;d.parseJSON=function(a){try{return n(a)}catch(b){var d=a.replace(/[\n\r]+\s*\/\/[^\n\r]*/g,"");if(d!=a)return n(d);throw b;}};d.createXHR=function(a){g({XMLHttpRequest:function(){return new t.XMLHttpRequest},MSXML2:function(){return new ActiveXObject("Msxml2.XMLHTTP")},MSXML:function(){return new ActiveXObject("Microsoft.XMLHTTP")},MSXML24:function(){return new ActiveXObject("Msxml2.XMLHTTP.4.0")},
REQUEST:function k(){return k.xhr||(k.xhr=require("sdk/request"))}},function(b,f){try{return a=f(),d.createXHR=f,d.xhr_type=b,!1}catch(g){}});return a};d.xhr_supported=d.createXHR(!1)})(encodeURIComponent,JSON,f);f.name=B;f.version="1.0.3";return f})})("jajax",this,Object,Array,Function,Date);