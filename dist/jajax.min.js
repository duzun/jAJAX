/*
 MIT
  @version 1.5.2
  @git https://github.com/duzun/jAJAX
  @umd AMD, Browser, CommonJs
  @author Dumitru Uzun (https://DUzun.Me)
*/
(function(z,n){"object"===typeof exports&&"undefined"!==typeof module?module.exports=n():"function"===typeof define&&define.amd?define(n):(z="undefined"!==typeof globalThis?globalThis:z||self,z.jajax=n())})(this,function(){function z(a){"@babel/helpers - typeof";return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},z(a)}function n(a,g,d,h){"String"==
C(a)&&(g&&"Object"==C(g)?(g.url=a,a=g,g=d,d=h):a={url:a});a=I({url:"",type:"GET",cache:!1,timeout:null,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"",mimeType:"",data:null,headers:null,error:null,success:null},a);!g&&a.success&&(g=a.success,delete a.success);!d&&a.error&&(d=a.error,delete a.error);var f=n.createXHR(!1);if(!f)return d&&d(null,"xhr",Error("Couldn't create XHR object")),f;var D={};h=function(b,c){D[b.toLowerCase()]=[b,c]};var p=a.method||a.type,e=a.url,l,
m,r,x,A=function(b,c,k,t){b||(b=k&&k.statusText)||(b="jajax error: ".concat(c||"unknown"));"string"==typeof b&&(b=Error(b));b&&(c&&(b.type=c),k&&k.status&&(b.status=k.status));a.error&&a.error(k||t,c,b,t);d&&d(k||t,c,b,t);x&&(b&&(b.xhr=k||t,b.response=t),x(b))},B=function(b,c,k){var t=a.dataType||a.mimeType&&n.mimeToDataType(a.mimeType)||m;try{switch(t){case "json":c="responseJSON"in b?b.responseJSON:N.test(c)?null:n.parseJSON(c);break;case "xml":c=b.responseXML;break;case "script":N.test(c)||(0,eval)(c)}}catch(S){var O=
S}O?A(O,"parsererror",b,k):(a.success&&a.success(c,b.statusText,b,k),g&&g(c,b.statusText,b,k),r&&r(c))},v=function(b,c){l&&T(l);var k=b.responseText||b.response;m=n.mimeToDataType(b.getResponseHeader("content-type"));if("json"==m&&!("responseJSON"in b))if(/^\s*$/.test(k))b.responseJSON=null;else try{b.responseJSON=n.parseJSON(k)}catch(t){}200<=b.status&&300>b.status||304==b.status?B(b,k,c):A(b.statusText||null,b.status?"error":"abort",b,c)};if(!g&&!d&&"function"==typeof Promise){var q=new Promise(function(b,
c){r=b;x=c});var P=q.then.bind(q);q=q["catch"].bind(q)}u({"X-Requested-With":"XMLHttpRequest",Accept:(J[a.dataType]?J[a.dataType]+", ":"")+"*/*; q=0.01"},h);a.contentType&&h("Content-Type",a.contentType);u(a.headers,h);p=p.toLowerCase();!a.data||"get"!=p&&"head"!=p||(e+=(0>e.indexOf("?")?"?":"&")+n.param(a.data),a.data=null);if("REQUEST"==n.xhr_type){u(a.data,function(b,c,k){null==c&&delete k[b]});var y={url:e,content:a.data||{},headers:{},onComplete:function(b){y.aborted||v({getResponseHeader:function(c){return b.headers[c]},
status:b.status,statusText:b.statusText,responseText:b.text,responseJSON:b.json},b)}};u(D,function(b,c){c[0]&&null!=c[0]&&(y.headers[c[0]]=c[1])});a.contentType&&(y.contentType=a.contentType);0<a.timeout&&(l=K(function(){y.aborted=U();A(null,"timeout",f)},a.timeout));try{var w=f.Request(y);w[p]()}catch(b){try{y.headers["X-HTTP-Method-Override"]=p.toUpperCase(),w=f.Request(y),w.post()}catch(c){switch(p){case "delete":w=new (require("sdk/net/xhr").XMLHttpRequest);w.open(p,e);u(y.headers,function(k,
t){w.setRequestHeader(k,t)});w.send();v(w);break;default:throw c;}}}w&&(f=w)}else f.open(p,e,!0),u(D,function(b,c){null!=c[1]&&f.setRequestHeader(c[0],c[1]+"")}),0<a.timeout&&(l=K(function(){f.onreadystatechange=Q;f.abort();A(null,"timeout",f)},a.timeout)),h=function(){4==f.readyState&&(f.onreadystatechange=Q,v(f))},f.send(a.data?"string"==typeof a.data?a.data:n.param(a.data):null),4===f.readyState?K(h):f.onreadystatechange=h;P&&!f.then&&(f.then=P,q&&(f["catch"]=q));return f}function C(a){return null===
a?"Null":a===V?"Undefined":W.call(a).slice(8,-1)}function E(a){return a instanceof Function||"Function"==C(a)}function R(a){return L.call(a,"length")&&"number"===typeof a.length&&!E(a)}function u(a,g){if(!a)return a;if(F(a)||R(a))for(var d=0,h=a.length>>>0;d<h;d++){if(L.call(a,d)){var f=a[d];if(!1===g.call(f,d,f,a))return d}}else for(d in a)if(L.call(a,d)&&(h=a[d],!1===g.call(h,d,h,a)))return d;return a}function I(a){var g=function(d,h){a[d]=h};u(arguments,function(d,h){d&&u(h,g)});return a}var G=
"undefined"==typeof globalThis?"undefined"==typeof global?self:global:globalThis,V,Q=function(){},M=Object.prototype,L=M.hasOwnProperty,W=M.toString,U="function"==typeof Date.now?function(){return Date.now()}:function(){return new Date.getTime},F=E(Array.isArray)?Array.isArray:Array.isArray=function(a){return a instanceof Array||"Array"==C(a)},H="undefined"!==typeof self&&E(self.setTimeout)?self:G;E(H.setTimeout)||"undefined"!==typeof require&&(H=require("sdk/timers"));var K=H.setTimeout,T=H.clearTimeout,
N=/^\s*$/,J={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"};(function(a,g,d){function h(e,l,m,r){var x=F(l),A=l&&l!==G&&!x&&Object.getPrototypeOf(l)===M;u(l,function(B,v){var q=F(v)?"array":z(v);r&&(B=m?r:r+"["+(A||"object"==q||"array"==q?B:"")+"]");!r&&x?e.add(v.name,v.value):"array"==q||!m&&"object"==q?h(e,v,m,B):e.add(B,v)})}d.param=function(e,l){var m=[];m.add=function(r,x){this.push(a(r)+(null==x?"":"="+a(x)))};h(m,e,l);
return m.join("&").replace(/%20/g,"+")};var f=/^(?:text|application)\/javascript/i,D=/^(?:text|application)\/xml/i;d.mimeToDataType=function(e){e&&(e=e.split(";",2)[0]);return e&&("text/html"==e?"html":"application/json"==e?"json":f.test(e)?"script":D.test(e)&&"xml")||"text"};var p=g&&g.parse||G.json_decode;d.parseJSON=function(e){try{return p(e)}catch(m){var l=e.replace(/[\n\r]+\s*\/\/[^\n\r]*/g,"");if(l!=e)return p(l);throw m;}};d.createXHR=function(e){u({XMLHttpRequest:function(){return new G.XMLHttpRequest},
MSXML2:function(){return new ActiveXObject("Msxml2.XMLHTTP")},MSXML:function(){return new ActiveXObject("Microsoft.XMLHTTP")},MSXML24:function(){return new ActiveXObject("Msxml2.XMLHTTP.4.0")},REQUEST:function(){return require("sdk/request")},node_XMLHttpRequest:function(){return new (require("xmlhttprequest").XMLHttpRequest)}},function(l,m){try{return e=m(),d.createXHR=m,d.xhr_type=l,!1}catch(r){}});return e};d.xhr_supported=d.createXHR(!1)})(encodeURIComponent,JSON,n);I(n,{version:"1.5.2",accepts:J,
each:u,extend:I,type:C,isFunction:E,isArray:F,isArrayLike:R});return n});
