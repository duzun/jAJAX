/*
 MIT
  @version 1.2.0
  @git https://github.com/duzun/jAJAX
  @umd AMD, Browser, CommonJs
  @author DUzun.Me
*/
(function(F,q,y,w,I,z){("function"==typeof define&&define.amd?define:"undefined"!=typeof module&&module.exports?function(v,k){module.exports=k()}:function(v,k){q[F]=k()})([],function(){function v(e){return null===e?"Null":void 0===e?"Undefined":J.call(e).slice(8,-1)}function k(e){return e instanceof I||"Function"==v(e)}function n(e,f){if(!e)return e;var a,b,r;(b=A(e))||(b=B.call(e,"length")&&"number"===typeof e.length&&!k(e));if(b)for(a=0,r=e.length>>>0;a<r;a++){if(B.call(e,a)&&(b=e[a],!1===f.call(b,
a,b,e)))return a}else for(a in e)if(B.call(e,a)&&(b=e[a],!1===f.call(b,a,b,e)))return a;return e}function K(e){function f(a,b){e[a]=b}n(arguments,function(a,b){a&&n(b,f)});return e}var G=y.noop||function(){},C=y.prototype,B=C.hasOwnProperty,J=C.toString,L="function"==typeof z.now?function(){return z.now()}:function(){return new z.getTime},A=k(w.isArray)?w.isArray:w.isArray=function(e){return e instanceof w||"Array"==v(e)},g="undefined"!==typeof self&&k(self.setTimeout)?self:q;k(g.setTimeout)||"undefined"!==
typeof require&&(g=require("sdk/timers"));var D=g.setTimeout,M=g.clearTimeout,H={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},g=function f(a,b,r,l){var d=f.createXHR(!1);if(!d)return r&&r(null,"xhr","Couldn't create XHR object"),d;"String"==v(a)&&(b&&"Object"==v(b)?(b.url=a,a=b,b=r,r=l):a={url:a});a=K({url:"",type:"GET",cache:!1,timeout:null,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"",mimeType:"",
data:null,headers:null,error:null,success:null},a);var g={};l=function(a,c){g[a.toLowerCase()]=[a,c]};var c=a.method||a.type,h=a.url,t,E,p=function(m,c,b,d){a.error&&a.error(b||d,c,m,d);r&&r(b||d,c,m,d)},k=function(m,c,d){var t=a.dataType||a.mimeType&&f.mimeToDataType(a.mimeType)||E,h;try{switch(t){case "json":c="responseJSON"in m?m.responseJSON:/^\s*$/.test(c)?null:f.parseJSON(c);break;case "xml":c=m.responseXML;break;case "script":(0,eval)(c)}}catch(g){h=g}h?p(h,"parsererror",m,d):(a.success&&a.success(c,
m.statusText,m,d),b&&b(c,m.statusText,m,d))},q=function(a,c){t&&M(t);var b=a.responseText||a.response;E=f.mimeToDataType(a.getResponseHeader("content-type"));if("json"==E&&!("responseJSON"in a))if(/^\s*$/.test(b))a.responseJSON=null;else try{a.responseJSON=f.parseJSON(b)}catch(d){}200<=a.status&&300>a.status||304==a.status?k(a,b,c):p(a.statusText||null,a.status?"error":"abort",a,c)};n({"X-Requested-With":"XMLHttpRequest"},l);a.contentType&&l("Content-Type",a.contentType);l("Accept",(H[a.dataType]?
H[a.dataType]+", ":"")+"*/*; q=0.01");n(a.headers,l);c=c.toLowerCase();!a.data||"get"!=c&&"head"!=c||(h+=(0>h.indexOf("?")?"?":"&")+f.param(a.data),a.data=null);if("REQUEST"==f.xhr_type){n(a.data,function(a,c,b){null==c&&delete b[a]});var u={url:h,content:a.data?a.data:{},headers:{},onComplete:function(a){u.aborted||q({getResponseHeader:function(c){return a.headers[c]},status:a.status,statusText:a.statusText,responseText:a.text,responseJSON:a.json},a)}};n(g,function(a,c){c[0]&&null!=c[0]&&(u.headers[c[0]]=
c[1])});a.contentType&&(u.contentType=a.contentType);0<a.timeout&&(t=D(function(){u.aborted=L();p(null,"timeout",d)},a.timeout));try{d.Request(u)[c]()}catch(m){try{u.headers["X-HTTP-Method-Override"]=c.toUpperCase(),d.Request(u).post()}catch(N){switch(c){case "delete":var x=new (require("sdk/net/xhr").XMLHttpRequest);x.open(c,h);n(u.headers,function(a,c){x.setRequestHeader(a,c)});x.send();q(x);break;default:throw N;}}}}else d.open(c,h,!0),n(g,function(a,c){null!=c[1]&&d.setRequestHeader(c[0],c[1]+
"")}),0<a.timeout&&(t=D(function(){d.onreadystatechange=G;d.abort();p(null,"timeout",d)},a.timeout)),l=function(){4==d.readyState&&(d.onreadystatechange=G,q(d))},d.send(a.data?"string"==typeof a.data?a.data:f.param(a.data):null),4===d.readyState?D(l):d.onreadystatechange=l;return d};(function(f,a,b){function g(a,b,d,f){var p,k=A(b),l=b&&b!==q&&!k&&y.getPrototypeOf(b)===C;n(b,function(b,h){p=A(h)?"array":typeof h;f&&(b=d?f:f+"["+(l||"object"==p||"array"==p?b:"")+"]");!f&&k?a.add(h.name,h.value):"array"==
p||!d&&"object"==p?g(a,h,d,b):a.add(b,h)})}b.param=function(a,b){var d=[];d.add=function(a,c){this.push(f(a)+(null==c?"":"="+f(c)))};g(d,a,b);return d.join("&").replace(/%20/g,"+")};var l=/^(?:text|application)\/javascript/i,d=/^(?:text|application)\/xml/i;b.mimeToDataType=function(a){a&&(a=a.split(";",2)[0]);return a&&("text/html"==a?"html":"application/json"==a?"json":l.test(a)?"script":d.test(a)&&"xml")||"text"};var k=a&&a.parse||q.json_decode;b.parseJSON=function(a){try{return k(a)}catch(b){var d=
a.replace(/[\n\r]+\s*\/\/[^\n\r]*/g,"");if(d!=a)return k(d);throw b;}};b.createXHR=function(a){n({XMLHttpRequest:function(){return new q.XMLHttpRequest},MSXML2:function(){return new ActiveXObject("Msxml2.XMLHTTP")},MSXML:function(){return new ActiveXObject("Microsoft.XMLHTTP")},MSXML24:function(){return new ActiveXObject("Msxml2.XMLHTTP.4.0")},REQUEST:function t(){return t.xhr||(t.xhr=require("sdk/request"))}},function(d,f){try{return a=f(),b.createXHR=f,b.xhr_type=d,!1}catch(g){}});return a};b.xhr_supported=
b.createXHR(!1)})(encodeURIComponent,JSON,g);g.name=F;g.version="1.2.0";return g})})("jajax","undefined"==typeof global?this:global,Object,Array,Function,Date);